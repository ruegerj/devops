apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: app
  namespace: argocd
  finalizers:
    - resources-finalizer.argocd.argoproj.io
  labels:
    name: app
spec:
  project: default

  source:
    repoURL: https://github.com/ruegerj/devops  
    targetRevision: feature/app-telemetry
    path: infrastructure/argocd/deployment 
    directory:
      recurse: true

  destination:
    server: https://kubernetes.default.svc
    namespace: app

  info:
    - name: 'App:'
      value: 'https://app.g08.local'

  syncPolicy:
    automated: 
      prune: true 
      selfHeal: true 
    syncOptions:     
    - CreateNamespace=true 
    - PruneLast=true 


  ignoreDifferences:
  - group: apps
    kind: Deployment
    jsonPointers:
    - /spec/replicas

  revisionHistoryLimit: 10